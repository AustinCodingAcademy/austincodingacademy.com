{% for _page in site.pages %}
  {% if _page.settings %}
    {% assign settings = _page %}
    {% for _school in settings.schools %}
      {% if _school.key == site.key %}
        {% assign school = _school %}
      {% endif %}
    {% endfor %}
  {% endif %}
{% endfor %}
{% if page.schools %}
  {% for _school in page.schools %}
    {% if _school.key == site.key %}
      {% assign school = school | hash_concat: _school %}
    {% endif %}
  {% endfor %}
{% endif %}
<!-- htmllint preset="none" -->
{% if site.baseurl == '/amp' %}
<script async custom-element="amp-analytics" src="https://cdn.ampproject.org/v0/amp-analytics-0.1.js"></script>
{% else %}
<meta id="google-analytics" content="{{ school.google_analytics }}">
<meta id="callrail" content="{{ school.callrail_company_id }}">
<meta id="facebook-pixel" content="{{ settings.facebook_pixel }}">
<meta id="reddit-pixel" content="{{ school.reddit_pixel }}">
<meta id="linkedin-pixel" content="{{ settings.linkedin_pixel }}">
<meta id="google-ads-conversion-id" content="{{ school.google_ads_conversion_id }}">
<meta id="google-ads-conversion-label" content="{{ school.google_ads_conversion_label }}">
<!-- Google Tag Manager -->
<script>(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':
  new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],
  j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src=
  'https://www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);
  })(window,document,'script','dataLayer','{{ settings.google_tag_manager }}');</script>
  <!-- End Google Tag Manager -->
  <script>
  const decodeURLParams = search => {
    const hashes = search.slice(search.indexOf("?") + 1).split("&");
    return hashes.reduce((params, hash) => {
      const split = hash.indexOf("=");
      if (split < 0) return Object.assign(params, { [hash]: null });
      const key = hash.slice(0, split);
      const val = hash.slice(split + 1);
      return Object.assign(params, { [key]: decodeURIComponent(val) });
    }, {});
  };
  </script>
{% endif %}
<!-- htmllint preset="$previous" -->
